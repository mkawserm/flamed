syntax = "proto3";
package pb;

//option go_package = "pkg/pb";

message FlameEntry {
  bytes namespace = 1;
  bytes key = 2;
  bytes value = 3;
}

message FlameAction {
  enum FlameActionType {
    CREATE = 0;
    UPDATE = 1;
    APPEND = 2;
    DELETE = 3;
  }

  FlameActionType flameActionType = 1;
  FlameEntry flameEntry = 2;
}

message FlameBatchAction {
  repeated FlameAction flameActionList = 1;
}

message FlameBatchRead {
  repeated FlameEntry flameEntryList = 1;
}

message FlameSnapshotEntry {
  bytes uid = 1;
  bytes data = 2;
}

message FlameSnapshot {
  uint32 version = 1;
  uint64 length = 2;
  repeated FlameSnapshotEntry flameSnapshotEntryList = 3;
}

message FlameIndexField {
  enum IndexFieldType {
    TEXT = 0;
    NUMERIC = 1;
    BOOLEAN = 2;
    GEO_POINT = 3;
    DATE_TIME = 4;
  }

  IndexFieldType indexFieldType = 1;

  string name = 2;
  string analyzer = 3;
  bool enabled = 4;
  bool index = 5;
  bool store = 6;
  bool includeTermVectors = 7;
  bool includeInAll = 8;
  bool docValues = 9;
}

message FlameIndexMeta {
  bytes namespace = 1;
  uint32 version = 2;
  uint64 createdAt = 3;
  uint64 updatedAt = 4;
  repeated FlameIndexField flameIndexFieldList = 5;
}

message FlameUser {
  string username = 1;
  string password = 2;
  uint64 createdAt = 3;
  uint64 updatedAt = 4;

  bytes userData = 5;
}

message FlameACL {
  string username = 1;
  bytes namespace = 2;
  uint32 permission = 3;
}

message FlameProposal {
  enum FlameProposalType {
    BATCH_ACTION = 0; /* FlameBatchAction */

    ADD_INDEX_META = 1; /* FlameIndexMeta */
    DELETE_INDEX_META = 2; /* FlameIndexMeta */

    ADD_USER = 3; /* FlameUser */
    UPDATE_USER = 4; /* FlameUser */
    DELETE_USER = 5; /* FlameUser */

    ADD_ACL = 6; /* FlameACL */
    DELETE_ACL = 7; /* FlameACL */
  }

  FlameProposalType flameProposalType = 1;
  bytes flameProposalData = 2;
}